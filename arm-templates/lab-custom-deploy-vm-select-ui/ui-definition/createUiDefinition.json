{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {}
        ],
        "steps": [
			{
				"name": "attendees",
				"label": "Attendees",
				"elements": [
					{
						"name": "numOfAttendeesStep",
						"type": "Microsoft.Common.Slider",
						"label": "Number of attendees",
						"subLabel": "attendees",
						"toolTip": "Number of attendees to the training.",
						"showStepMarkers": false,
						"min": 1,
						"max": 20,
						"defaultValue": 8,
						"constraints": {
							"required": true
						},
						"visible": true
					}
				]
			},
			{
				"name": "emulatedOnPremisesEnvStep",
				"label": "Emulated on-premises environment",
				"elements": [
					{
						"name": "isDeployEmulatedOnPremisesEnv",
						"type": "Microsoft.Common.OptionsGroup",
						"label": "Deploy the emulated on-premises environment?",
						"toolTip": "",
						"defaultValue": "Yes",
						"constraints": {
						  "allowedValues": [
							{
							  "label": "Yes",
							  "value": true
							},
							{
							  "label": "No",
							  "value": false
							}
						  ],
						  "required": true
						},
						"visible": true
					},
					{
						"name": "vpnSettingsSection",
						"type": "Microsoft.Common.Section",
						"label": "VPN settings",
						"elements": [
							{
								"name": "vpnSharedKey",
								"type": "Microsoft.Common.TextBox",
								"label": "Shared key (PSK)",
								"toolTip": "A mixture of letters and numbers, used to establish encryption for the connection. The same shared key must be used in both the virtual network and local network gateways. If your gateway device doesn't provide one, you can make one up here and provide it to your device.",
								"placeholder": "Your shared key",
								"defaultValue": "",
								"constraints": {
									"required": true
								},
								"visible": true
							}
						],
						"visible": "[steps('emulatedOnPremisesEnvStep').isDeployEmulatedOnPremisesEnv]"
					}
				]
			},
			{
				"name": "jumpboxVmStep",
				"label": "Jump-box VM",
				"elements": [
					{
						"name": "isDeployJumpboxVm",
						"type": "Microsoft.Common.OptionsGroup",
						"label": "Deploy a jump-box VM for each attendee?",
						"toolTip": "",
						"defaultValue": "Yes",
						"constraints": {
						  "allowedValues": [
							{
							  "label": "Yes",
							  "value": true
							},
							{
							  "label": "No",
							  "value": false
							}
						  ],
						  "required": true
						},
						"visible": true
					},
					{
						"name": "adminAccountSection",
						"type": "Microsoft.Common.Section",
						"label": "Administrator account",
						"elements": [
							{
								"name": "adminUserName",
								"type": "Microsoft.Compute.UserNameTextBox",
								"label": "Username",
								"toolTip": "",
								"defaultValue": "AzureAdmin",
								"constraints": {
									"required": true,
									"regex": "^[a-z0-9A-Z]{1,20}$",
									"validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-20 characters long."
								},
								"osPlatform": "Windows",
								"visible": true
							},					
							{
								"name": "adminPassword",
								"type": "Microsoft.Compute.CredentialsCombo",
								"label": {
									"password": "Password",
									"confirmPassword": "Confirm password"
								},
								"toolTip": {
									"password": ""
								},
								"constraints": {
									"required": true,
									"customPasswordRegex": "^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
									"customValidationMessage": "The password must be alphanumeric, contain at least 12 characters, and have at least 1 letter and 1 number."
								},
								"options": {
									"hideConfirmation": false
								},
								"osPlatform": "Windows",
								"visible": true
							}
						],
						"visible": true
					},
					{
						"name": "vmSettingsSectoin",
						"type": "Microsoft.Common.Section",
						"label": "Virtual machine settings",
						"elements": [
							{
								"name": "jumpVmOsImage",
								"type": "Microsoft.Common.DropDown",
								"label": "OS image",
								"toolTip": "",
								"placeholder": "",
								"defaultValue": "Windows 10 Pro (127 GiB)",
								"constraints": {
									"allowedValues": [
										{
											"label": "Windows 10 Pro (127 GiB)",
											"value": "one"
										},
										{
											"label": "Windows Server 2019 Datacenter (127 GiB)",
											"value": "two"
										},
										{
											"label": "Windows Server 2019 Datacenter (30 GiB)",
											"value": "three"
										}
									],
									"required": true
								},
								"visible": true
							},
							{
								"name": "element1",
								"type": "Microsoft.Compute.SizeSelector",
								"label": "Size",
								"toolTip": "",
								"recommendedSizes": [
									"Standard_D1",
									"Standard_D2",
									"Standard_D3"
								],
								"constraints": {
									"allowedSizes": [],
									"excludedSizes": [],
									"numAvailabilityZonesRequired": 3,
									"zone": "3"
								},
								"options": {
									"hideDiskTypeFilter": false
								},
								"osPlatform": "Windows",
								"imageReference": {
									"publisher": "MicrosoftWindowsServer",
									"offer": "WindowsServer",
									"sku": "2012-R2-Datacenter"
								},
								"count": 2,
								"visible": true
							},
							{
								"name": "dropDown1",
								"type": "Microsoft.Common.DropDown",
								"label": "OS disk type",
								"toolTip": "",
								"placeholder": "",
								"defaultValue": "Value two",
								"constraints": {
									"allowedValues": [
										{
											"label": "Value one",
											"value": "one"
										},
										{
											"label": "Value two",
											"value": "two"
										}
									],
									"required": true
								},
								"visible": true
							}
						],
						"visible": true
					},
					{
						"name": "autoShutdownSection",
						"type": "Microsoft.Common.Section",
						"label": "Auto-shutdown",
						"elements": [
							{
								"name": "autoShutdownTime",
								"type": "Microsoft.Common.DropDown",
								"label": "Daily auto-shutdown time",
								"toolTip": "",
								"placeholder": "",
								"defaultValue": "23:30",
								"constraints": {
									"allowedValues": [
										{
											"label": "00:00",
											"value": "00:00"
										},
										{
											"label": "00:30",
											"value": "00:30"
										},
										{
											"label": "01:00",
											"value": "01:00"
										},
										{
											"label": "01:30",
											"value": "01:30"
										},
										{
											"label": "02:00",
											"value": "02:00"
										},
										{
											"label": "02:30",
											"value": "02:30"
										},
										{
											"label": "03:00",
											"value": "03:00"
										},
										{
											"label": "03:30",
											"value": "03:30"
										},
										{
											"label": "04:00",
											"value": "04:00"
										},
										{
											"label": "04:30",
											"value": "04:30"
										},
										{
											"label": "05:00",
											"value": "05:00"
										},
										{
											"label": "05:30",
											"value": "05:30"
										},
										{
											"label": "06:00",
											"value": "06:00"
										},
										{
											"label": "06:30",
											"value": "06:30"
										},
										{
											"label": "07:00",
											"value": "07:00"
										},
										{
											"label": "07:30",
											"value": "07:30"
										},
										{
											"label": "08:00",
											"value": "08:00"
										},
										{
											"label": "08:30",
											"value": "08:30"
										},
										{
											"label": "09:00",
											"value": "09:00"
										},
										{
											"label": "09:30",
											"value": "09:30"
										},
										{
											"label": "10:00",
											"value": "10:00"
										},
										{
											"label": "10:30",
											"value": "10:30"
										},
										{
											"label": "11:00",
											"value": "11:00"
										},
										{
											"label": "11:30",
											"value": "11:30"
										},
										{
											"label": "12:00",
											"value": "12:00"
										},
										{
											"label": "12:30",
											"value": "12:30"
										},
										{
											"label": "13:00",
											"value": "13:00"
										},
										{
											"label": "13:30",
											"value": "13:30"
										},
										{
											"label": "14:00",
											"value": "14:00"
										},
										{
											"label": "14:30",
											"value": "14:30"
										},
										{
											"label": "15:00",
											"value": "15:00"
										},
										{
											"label": "15:30",
											"value": "15:30"
										},
										{
											"label": "16:00",
											"value": "16:00"
										},
										{
											"label": "16:30",
											"value": "16:30"
										},
										{
											"label": "17:00",
											"value": "17:00"
										},
										{
											"label": "17:30",
											"value": "17:30"
										},
										{
											"label": "18:00",
											"value": "18:00"
										},
										{
											"label": "18:30",
											"value": "18:30"
										},
										{
											"label": "19:00",
											"value": "19:00"
										},
										{
											"label": "19:30",
											"value": "19:30"
										},
										{
											"label": "20:00",
											"value": "20:00"
										},
										{
											"label": "20:30",
											"value": "20:30"
										},
										{
											"label": "21:00",
											"value": "21:00"
										},
										{
											"label": "21:30",
											"value": "21:30"
										},
										{
											"label": "22:00",
											"value": "22:00"
										},
										{
											"label": "22:30",
											"value": "22:30"
										},
										{
											"label": "23:00",
											"value": "23:00"
										},
										{
											"label": "23:30",
											"value": "23:30"
										}
									],
									"required": true
								},
								"visible": true
							},
							{
								"name": "autoShutdownTimeZone",
								"type": "Microsoft.Common.DropDown",
								"label": "Auto-shutdown time zone",
								"toolTip": "",
								"placeholder": "",
								"defaultValue": "Value two",
								"constraints": {
									"allowedValues": [
										{
											"label": "Value one",
											"value": "one"
										},
										{
											"label": "Value two",
											"value": "two"
										}
									],
									"required": true
								},
								"visible": true
							}
						],
						"visible": true
            		}
				]
			},
            {
                "name": "tagsStep",
                "label": "Tags",
                "elements": [
                    {
                        "name": "tagsByResource",
                        "type": "Microsoft.Common.TagsByResource",
                        "resources": [
                            "Microsoft.Storage/storageAccounts",
                            "Microsoft.Compute/virtualMachines"
                        ]
                    }
                ]
            }
        ],
        "outputs": {
            "storageAccountNamePrefix": "[steps('storageConfig').storageAccounts.prefix]",
            "storageAccountType": "[steps('storageConfig').storageAccounts.type]",
            "location": "[location()]",
            "tagsByResource": "[steps('tags').tagsByResource]"
        }
    }
}
